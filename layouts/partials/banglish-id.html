{{/* Banglish ID Generator - deterministic Bangla to Banglish transliteration */}}
{{- $banglaMap := dict "অ" "o" "আ" "a" "ই" "i" "ঈ" "i" "উ" "u" "ঊ" "u" "এ" "e" "ঐ" "oi" "ও" "o" "ঔ" "ou" "ক" "k" "খ" "kh" "গ" "g" "ঘ" "gh" "ঙ" "ng" "চ" "ch" "ছ" "ch" "জ" "j" "ঝ" "jh" "ঞ" "n" "ট" "t" "ঠ" "th" "ড" "d" "ঢ" "dh" "ণ" "n" "ত" "t" "থ" "th" "দ" "d" "ধ" "dh" "ন" "n" "প" "p" "ফ" "f" "ব" "b" "ভ" "bh" "ম" "m" "য" "j" "র" "r" "ল" "l" "শ" "sh" "ষ" "sh" "স" "sh" "হ" "h" "ং" "n" "ঁ" "" "ঃ" "" "ক্ষ" "kho" "ত্র" "tro" "জ্ঞ" "gya" "শ্র" "shro" -}}

{{- $input := . -}}
{{- $result := "" -}}

{{- /* Handle compound letters first */}}
{{- $result = replaceRE "ক্ষ" "kho" $input -}}
{{- $result = replaceRE "ত্র" "tro" $result -}}
{{- $result = replaceRE "জ্ঞ" "gya" $result -}}
{{- $result = replaceRE "শ্র" "shro" $result -}}

{{- /* Remove special marks */}}
{{- $result = replaceRE "[ঁঃ]" "" $result -}}
{{- $result = replaceRE "ং" "n" $result -}}

{{- /* Transliterate remaining characters */}}
{{- range $key, $value := $banglaMap -}}
  {{- $result = replaceRE $key $value $result -}}
{{- end -}}

{{- /* Normalize for URL */}}
{{- $result = replaceRE "[^a-zA-Z0-9\\s-]" "" $result -}}
{{- $result = replaceRE "\\s+" "-" $result -}}
{{- $result = replaceRE "-+" "-" $result -}}
{{- $result = replaceRE "^-+" "" $result -}}
{{- $result = replaceRE "-+$" "" $result -}}
{{- $result = lower $result -}}

{{- $result -}}